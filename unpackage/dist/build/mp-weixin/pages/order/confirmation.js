(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/confirmation"],{4793:function(t,s,e){"use strict";e("9bb1");var a=i(e("b0ce")),o=i(e("fbbf"));function i(t){return t&&t.__esModule?t:{default:t}}Page((0,a.default)(o.default))},"580e":function(t,s,e){"use strict";e.r(s);var a=e("a675"),o=e.n(a);for(var i in a)"default"!==i&&function(t){e.d(s,t,function(){return a[t]})}(i);s["default"]=o.a},"61e9":function(t,s,e){},"771b":function(t,s,e){"use strict";var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("view",{staticClass:"confirm"},[e("view",{staticClass:"send"},[e("view",{staticClass:"send-title"},[t._v("配送方式")]),e("view",{staticClass:"send-type",attrs:{eventid:"7c20012d-0"},on:{click:function(s){t.sendType()}}},[e("text",[t._v("已选")]),e("text",[t._v(t._s(1==t.getgoods_name?"自提":"送货上门"))]),e("image",{staticClass:"right-jiantou",attrs:{src:"../../static/img/category/youce-jiantou.png"}})])]),e("view",{staticClass:"addr"},[e("view",{staticClass:"sendgoods-info"},[t._v("配送信息")]),t.address?e("view",{staticClass:"sendgoods-addr"},[e("view",[e("text",{directives:[{name:"show",rawName:"v-show",value:1==t.getgoods_name,expression:"getgoods_name==1"}],staticClass:"getgoods-name"},[t._v(t._s(t.addrList.name))]),e("text",{staticClass:"getgoods-people"},[t._v(t._s(t.addrList.username)+t._s(t.addrList.name)+"    "+t._s(t.addrList.phone))]),e("text",{staticClass:"getgoods-addr"},[t._v(t._s(t.addrList.province_name)+t._s(t.addrList.city_name)+t._s(t.addrList.area_name)+" "+t._s(t.addrList.street_name)+" "+t._s(t.addrList.address_name)+"\n\t\t\t\t    "+t._s(t.addrList.province)+t._s(t.addrList.city)+t._s(t.addrList.area)+t._s(t.addrList.street)+t._s(t.addrList.address))])])]):t._e()]),e("view",{staticClass:"buy-list"},[t._l(t.buyList,function(s,a){return e("view",{key:a,staticClass:"row"},[e("view",{staticClass:"goods-info"},[e("view",{staticClass:"img"},[e("image",{attrs:{src:s.goods_logo}})]),e("view",{staticClass:"info"},[e("view",{staticClass:"title"},[t._v(t._s(s.goods_title))]),e("view",{staticClass:"spec"},[e("text",[t._v(t._s(s.goods_spec))])]),e("view",{staticClass:"price-number"},[e("view",{staticClass:"price"},[t._v("￥"+t._s(s.price_selling))]),e("view",{staticClass:"number"},[t._v("x"+t._s(s.goods_number))])])])])])}),e("view",{staticClass:"total-money"},[e("view",{staticClass:"send-money"},[e("text",[t._v("配送费")]),e("text",[t._v("￥"+t._s(t.express))])]),e("view",{staticClass:"total-pay-money"},[e("text",[t._v("共"+t._s(t.number)+"件商品")]),e("view",{staticClass:"pay-money"},[e("text",[t._v("合计：")]),e("text",[t._v("￥"+t._s(t.total))])])])])],2),e("view",{staticClass:"footer"},[e("view",{staticClass:"settlement"},[e("view",{staticClass:"sum"},[t._v("待支付:"),e("view",{staticClass:"money"},[t._v("￥"+t._s(t.totalmoney))])]),e("view",{staticClass:"btn",attrs:{eventid:"7c20012d-1"},on:{tap:t.toPay}},[t._v("去结算")])])])])},o=[];e.d(s,"a",function(){return a}),e.d(s,"b",function(){return o})},a675:function(t,s,e){"use strict";(function(t){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var e={mounted:function(){var s=this;t.getStorage({key:"address",success:function(t){var e=JSON.parse(t.data);console.log("address",t,e),e.distance?(console.log(2),console.log(e.distance),s.getgoods_name=1):(console.log(1),s.addrList=e,s.getgoods_name=2)}})},computed:{totalmoney:function(){var t=Number(this.total)+Number(this.express);return t}},data:function(){return{buyList:[],goodsinfo:{},number:"",goodsPrice:0,sumPrice:0,address:9,addrList:{},goods:[],express:"",total:"",iscart:"",getgoods_name:!1,order_no:""}},onLoad:function(s){var e=this;console.log(s),t.getStorage({key:"cart",success:function(s){if(console.log("liji",s),e.iscart=s.data.isCart,0==s.data.isCart){var a={goods_id:s.data.goods.id,goods_number:s.data.goods.goods_number,goods_spec:s.data.goods.goods_spec};e.goods.push(a),t.request({url:e.config.url+"order/sure",method:"post",data:{token:e.token,goods:e.goods},success:function(t){1==t.data.code&&(e.buyList=t.data.data.goods,e.express=t.data.data.express,e.total=t.data.data.total,e.number=t.data.data.number)}})}else e.goods=s.data.goods,t.request({url:e.config.url+"order/sure",method:"post",data:{token:e.token,goods:e.goods},success:function(t){console.log("cart",t),1==t.data.code&&(e.buyList=t.data.data.goods,e.express=t.data.data.express,e.total=t.data.data.total,e.number=t.data.data.number)}})}})},onBackPress:function(){this.clearOrder()},filters:{toFixed:function(t){return parseFloat(t).toFixed(2)}},methods:{sendType:function(){t.navigateTo({url:"/pages/sendType/sendType"})},clearOrder:function(){var s=this;t.removeStorage({key:"buylist",success:function(t){s.buylist=[]}})},toPay:function(){var s=this;t.request({url:this.config.url+"order/order",method:"post",data:{token:this.token,goods:this.goods,order_type:this.getgoods_name,address_id:this.addrList.id,from_car:this.iscart},success:function(e){console.log(e),1==e.data.code?(s.order_no=e.data.data.order_no,t.request({url:s.config.url+"order/pay",method:"POST",data:{token:s.token,order_no:s.order_no},success:function(s){if(console.log(s),1==s.data.code){var e=s.data.data.data;t.requestPayment({provider:"wxpay",appid:e.appId,timeStamp:e.timeStamp,nonceStr:e.nonceStr,package:e.package,signType:e.signType,paySign:e.paySign,success:function(s){console.log("success:"+JSON.stringify(s)),t.navigateTo({url:"/pages/user/order_list/order_list?tbIndex=2"})},fail:function(s){console.log("fail:"+JSON.stringify(s)),t.switchTab({url:"/pages/tabBar/home"}),t.showToast({title:"支付失败"})}})}}})):0==e.data.code&&t.showToast({title:"提交订单失败",duration:1e3})}})}}};s.default=e}).call(this,e("543d")["default"])},c6a1:function(t,s,e){"use strict";var a=e("61e9"),o=e.n(a);o.a},fbbf:function(t,s,e){"use strict";e.r(s);var a=e("771b"),o=e("580e");for(var i in o)"default"!==i&&function(t){e.d(s,t,function(){return o[t]})}(i);e("c6a1");var n=e("2877"),d=Object(n["a"])(o["default"],a["a"],a["b"],!1,null,null,null);s["default"]=d.exports}},[["4793","common/runtime","common/vendor"]]]);